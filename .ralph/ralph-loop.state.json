{
  "active": true,
  "iteration": 1,
  "minIterations": 1,
  "maxIterations": 0,
  "completionPromise": "COMPLETE",
  "tasksMode": true,
  "taskPromise": "READY_FOR_NEXT_TASK",
  "prompt": "\n# Product Requirements Document: Projector\n\nVersion: 1.0  \nDate: 2026-02-20  \nStatus: Draft\n\nâ”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”\n\n\n## 1. Overview\n\nProjector is a terminal user interface (TUI) application for developers to manage and monitor multiple Git-based projects from a single dashboard. Built on the BubbleTea v2 scaffold, it scans a configured directory for Git repositories and provides real-time status, metadata, and quick access to external tools. A scaffold is setup in ./projector/\n\nâ”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”\n\n\n## 2. Goals & Objectives\n\n### Primary Goals\n- Provide instant visibility into all active projects in a developer's workspace\n- Display comprehensive Git status (branch, changes, push/pull state, last commit)\n- Enable quick navigation and filtering across projects\n- Support launching projects in terminal or editor with minimal friction\n\n### Success Metrics\n- Scan and display 50+ projects in <2 seconds\n- Support filtering/grouping with <100ms response time\n- Zero-config startup with sensible defaults\n\nâ”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”\n\n\n## 3. User Personas\n\nPrimary: Solo developer or tech lead managing 10-100 local repositories across multiple languages/frameworks.\n\nUse Cases:\n- Morning standup: quickly check which projects have uncommitted work\n- Context switching: find and open a specific project by name or language\n- Status overview: see which projects are ahead/behind remote branches\n\nâ”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”\n\n\n## 4. Functional Requirements\n\n### 4.1 Project Discovery\n\nFR-1.1: Scan immediate subdirectories (depth 1) of a configured root directory  \nFR-1.2: Identify projects by presence of .git directory  \nFR-1.3: Support both:\n- Settings screen to change scan directory (persistent to config)\n- Command-line flag --projects-dir <path> to override on launch\n\n### 4.2 Git Status Information\n\nFR-2.1: Display for each project:\n- Current branch name\n- Uncommitted changes count (staged + unstaged)\n- Unpushed commits count\n- Unpulled commits count (ahead/behind remote)\n- Last commit message (truncated to 60 chars)\n- Last commit timestamp (relative, e.g., \"2 hours ago\")\n- Remote tracking status (up-to-date, ahead, behind, diverged, no remote)\n\nFR-2.2: Visual indicators:\n- Clean status (green checkmark)\n- Dirty status (yellow dot)\n- Unpushed commits (orange up arrow)\n- Unpulled commits (blue down arrow)\n- Diverged (red warning icon)\n\n### 4.3 Project Metadata\n\nFR-3.1: Detect language/framework from:\n- package.json â†’ Node.js\n- go.mod â†’ Go\n- Cargo.toml â†’ Rust\n- pyproject.toml / requirements.txt â†’ Python\n- pom.xml / build.gradle â†’ Java\n- Gemfile â†’ Ruby\n- .csproj / .sln â†’ C#\n\nFR-3.2: Display:\n- Last modified timestamp (most recent file change in project root)\n- Project size (disk usage, human-readable: KB/MB/GB)\n\n### 4.4 Navigation & UI\n\nFR-4.1: Primary view: List + Dashboard hybrid\n- Scrollable list of projects (arrow keys)\n- Each row shows: name, language icon, git status icons, branch, last commit\n- Press Enter on a project â†’ detail panel (dashboard card) overlays or replaces list\n\nFR-4.2: Detail view shows:\n- Full project path\n- All git status details (FR-2.1)\n- Language/framework\n- Last modified, size\n- Available actions (FR-5)\n\nFR-4.3: Search/filter bar (toggle with / key):\n- Fuzzy search by project name\n- Filter by language (e.g., /lang:go)\n- Filter by git status (e.g., /dirty, /unpushed)\n\nFR-4.4: Grouping modes (toggle with g key, cycle through):\n- Flat list (default)\n- Group by parent directory\n- Group by language\n- Group by git status (clean, dirty, unpushed, unpulled, diverged)\n\n### 4.5 Actions\n\nFR-5.1: Read-only status display (default view)\n\nFR-5.2: Open in external tools (from detail view or via hotkey):\n- o â†’ Open in terminal (spawn $SHELL in project directory)\n- e â†’ Open in editor (spawn $EDITOR or configured command)\n\nFR-5.3: Command configuration:\n- Detect $EDITOR and $SHELL from environment\n- Allow override in config file:\n json\n  {\n    \"commands\": {\n      \"editor\": \"code .\",\n      \"terminal\": \"wezterm start --cwd\"\n    }\n  }\n  \n\n### 4.6 Refresh Behavior\n\nFR-6.1: Auto-refresh when TUI gains focus (detect terminal focus events if supported, fallback to manual)  \nFR-6.2: Manual refresh with r key  \nFR-6.3: Show \"Scanning...\" loading state during background scan\n\n### 4.7 Performance\n\nFR-7.1: Asynchronous scanning:\n- Display cached results immediately on startup\n- Scan in background, update UI incrementally as projects are discovered\n- Show spinner/progress indicator during scan\n\nFR-7.2: Git operations run concurrently (goroutine pool, max 10 concurrent)\n\nâ”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”\n\n\n## 5. Non-Functional Requirements\n\n### 5.1 Performance\n- Initial render: <500ms (with cached data)\n- Full scan of 100 projects: <3 seconds\n- UI responsiveness: <16ms frame time (60 FPS)\n\n### 5.2 Compatibility\n- Linux, macOS, Windows (via WSL or native)\n- Terminals: iTerm2, Alacritty, WezTerm, Windows Terminal, Kitty\n\n### 5.3 Configuration\n- Config file: ~/.projector.json (extends scaffold's existing config schema)\n- New fields:\n json\n  {\n    \"projectsDir\": \"~/projects\",\n    \"commands\": {\n      \"editor\": \"$EDITOR\",\n      \"terminal\": \"$SHELL\"\n    },\n    \"scan\": {\n      \"autoRefreshOnFocus\": true\n    }\n  }\n  \n\n### 5.4 Logging\n- Debug mode (--debug) logs:\n  - Scan duration per project\n  - Git command execution time\n  - Errors (missing remotes, detached HEAD, etc.)\n\nâ”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”\n\n\n## 6. User Interface Specification\n\n### 6.1 Main Screen (List View)\n\nâ”Œâ”€ Projector â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”\nâ”‚ ğŸ“ ~/projects (42 projects)                    [Filter: /unpushed] â”‚\nâ”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤\nâ”‚ â— myapp              ğŸŸ¢ main â†‘2        \"Fix login bug\"    2h ago   â”‚\nâ”‚ â— api-server      ğŸ¹ ğŸŸ¡ dev  â†“1 â†‘3    \"Add metrics\"      1d ago   â”‚\nâ”‚ â— frontend        âš›ï¸ ğŸ”´ feat âš ï¸       \"WIP: redesign\"    3h ago   â”‚\nâ”‚   ...                                                               â”‚\nâ”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤\nâ”‚ â†‘/â†“: navigate  Enter: details  /: filter  g: group  o: open  q: quitâ”‚\nâ””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜\n\n\n### 6.2 Detail View (Dashboard Card)\n\nâ”Œâ”€ api-server â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”\nâ”‚ Path: ~/projects/api-server                                        â”‚\nâ”‚ Language: Go (go.mod)                                              â”‚\nâ”‚ Size: 45.2 MB  Modified: 6 hours ago                               â”‚\nâ”‚                                                                     â”‚\nâ”‚ Git Status:                                                        â”‚\nâ”‚   Branch: dev                                                      â”‚\nâ”‚   Remote: origin/dev (behind 1, ahead 3)                           â”‚\nâ”‚   Uncommitted: 5 files (3 staged, 2 unstaged)                     â”‚\nâ”‚   Last commit: \"Add metrics endpoint\" (John Doe, 1 day ago)       â”‚\nâ”‚                                                                     â”‚\nâ”‚ Actions:                                                           â”‚\nâ”‚   [o] Open in terminal                                             â”‚\nâ”‚   [e] Open in editor                                               â”‚\nâ”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤\nâ”‚ Esc: back  o: terminal  e: editor                                  â”‚\nâ””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜\n\n\n### 6.3 Settings Screen\n\nExtend existing scaffold settings with:\n- Projects Directory (text input with path validation)\n- Editor Command (text input, default: $EDITOR)\n- Terminal Command (text input, default: $SHELL)\n- Auto-refresh on focus (toggle)\n\nâ”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”\n\n\n## 7. Technical Architecture\n\n### 7.1 New Packages\n\ninternal/\n  projector/\n    scanner.go          # Directory scanning, .git detection\n    git.go              # Git status queries (branch, diff, log)\n    metadata.go         # Language detection, size calculation\n    project.go          # Project struct, aggregated data\n  ui/screens/\n    projects_list.go    # Main list view (FR-4.1)\n    project_detail.go   # Detail card (FR-4.2)\n    projects_settings.go # Extend settings screen\n\n\n### 7.2 Data Model\n\ngo\ntype Project struct {\n    Name          string\n    Path          string\n    Language      string        // \"Go\", \"Node.js\", etc.\n    Size          int64         // bytes\n    LastModified  time.Time\n    Git           GitStatus\n}\n\ntype GitStatus struct {\n    Branch          string\n    Remote          string\n    Uncommitted     int         // staged + unstaged\n    Unpushed        int\n    Unpulled        int\n    LastCommitMsg   string\n    LastCommitTime  time.Time\n    LastCommitAuthor string\n    Status          StatusType  // Clean, Dirty, Ahead, Behind, Diverged\n}\n\n\n### 7.3 Concurrency\n\n- Scanner spawns goroutines per project (pooled, max 10)\n- Each goroutine:\n  1. Checks .git existence\n  2. Runs git status --porcelain, git log -1, git rev-list @{u}..HEAD, etc.\n  3. Detects language files\n  4. Calculates size\n  5. Sends result to channel â†’ UI updates incrementally\n\n### 7.4 Caching\n\n- Cache scan results in memory (map[string]Project)\n- Persist to ~/.cache/projector/projects.json on exit\n- Load cache on startup for instant display\n\nâ”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”\n\n\n## 8. Implementation Phases\n\n### Phase 1: Core Scanning (MVP)\n- FR-1.1, FR-1.2: Directory scanning, .git detection\n- FR-2.1: Basic git status (branch, uncommitted, unpushed)\n- FR-4.1: Simple list view\n- FR-6.2: Manual refresh\n\n### Phase 2: Enhanced Status & Metadata\n- FR-2.1: Full git status (unpulled, last commit, remote tracking)\n- FR-3.1, FR-3.2: Language detection, size, last modified\n- FR-4.2: Detail view\n\n### Phase 3: Filtering & Grouping\n- FR-4.3: Search/filter bar\n- FR-4.4: Grouping modes\n\n### Phase 4: Actions & Configuration\n- FR-5.2, FR-5.3: Open in terminal/editor\n- FR-1.3: Settings screen + CLI flag for projects directory\n- FR-6.1: Auto-refresh on focus\n\n### Phase 5: Performance & Polish\n- FR-7.1, FR-7.2: Async scanning, caching\n- Visual refinements (icons, colors, animations)\n- Error handling (missing git, permission errors)\n\nâ”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”\n\n\n## 9. Open Questions\n\n1. Submodules: Should projects with submodules show nested status?  \n Recommendation: Phase 2+ feature, show indicator only in Phase 1\n\n2. Non-Git projects: Should non-Git directories be shown (e.g., \"Not a repo\")?  \n Recommendation: No, focus on Git projects only\n\n3. Remote operations: Should we fetch from remote to get accurate ahead/behind?  \n Recommendation: No auto-fetch (slow), show last known state, add manual \"Fetch All\" action in Phase 4\n\n4. Multi-root support: Allow multiple scan directories simultaneously?  \n Recommendation: Phase 4+, single directory for MVP\n\nâ”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”\n\n\n## 10. Success Criteria\n\n- [ ] Scans 50 projects in <2 seconds\n- [ ] Displays all FR-2.1 git status fields accurately\n- [ ] Filter by language and git status works with <100ms latency\n- [ ] Opens project in terminal/editor without errors on Linux/macOS\n- [ ] Config file changes persist across restarts\n- [ ] Zero crashes on malformed Git repos or permission errors\n\nâ”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”\n\n\n## 11. Risks & Mitigations\n\n| Risk | Impact | Mitigation |\n|------|--------|------------|\n| Slow git operations on large repos | High | Timeout git commands (5s), show \"Timeout\" status |\n| Missing git binary | High | Check git --version on startup, show error screen |\n| Permission errors on scan | Medium | Skip inaccessible directories, log to debug.log |\n| Terminal focus detection unsupported | Low | Fallback to manual refresh only |\n\nâ”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”\n\n\n## 12. Appendix\n\n### A. Language Detection Rules\n\n| File | Language |\n|------|----------|\n| package.json | Node.js |\n| go.mod | Go |\n| Cargo.toml | Rust |\n| pyproject.toml, requirements.txt | Python |\n| pom.xml, build.gradle | Java |\n| Gemfile | Ruby |\n| .csproj, .sln | C# |\n\nPriority: First match wins (check in order above).\n\n### B. Git Commands\n\nbash\n# Branch name\ngit rev-parse --abbrev-ref HEAD\n\n# Uncommitted changes\ngit status --porcelain | wc -l\n\n# Unpushed commits\ngit rev-list @{u}..HEAD --count\n\n# Unpulled commits\ngit rev-list HEAD..@{u} --count\n\n# Last commit\ngit log -1 --format=\"%s|%ar|%an\"\n\n# Remote tracking branch\ngit rev-parse --abbrev-ref @{u}\n\n\n### C. Config Schema Extension\n\njson\n{\n  \"logLevel\": \"info\",\n  \"debug\": false,\n  \"ui\": { ... },\n  \"app\": { ... },\n  \"projector\": {\n    \"projectsDir\": \"~/projects\",\n    \"commands\": {\n      \"editor\": \"$EDITOR\",\n      \"terminal\": \"$SHELL\"\n    },\n    \"scan\": {\n      \"autoRefreshOnFocus\": true,\n      \"concurrency\": 10,\n      \"gitTimeout\": 5\n    }\n  }\n}\n",
  "startedAt": "2026-02-20T19:35:38.098Z",
  "model": "",
  "agent": "opencode"
}