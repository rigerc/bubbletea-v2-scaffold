# Code-Assist: Flexible TDD Implementation from Any Starting Point
# Pattern: Adaptive Implementation Entry Point
# Implements from PDD output, code tasks, or rough descriptions using TDD
#
# Extracted from idea-to-commit.yml - this preset handles the implementation phase only.
# Use idea-to-commit.yml for full idea→design→implement→commit flow.
#
# 4 Hats:
# - Bootstrapper: Detects input type and bootstraps the implementation context
# - Builder: TDD implementation (RED → GREEN → REFACTOR)
# - Validator: Exhaustive quality gate with manual E2E testing
# - Committer: Creates conventional commits after validation
#
# Usage:
#   # From PDD output directory:
#   ralph run --config presets/code-assist.yml --prompt ".ralph/specs/my-feature"
#
#   # From a single code task:
#   ralph run --config presets/code-assist.yml --prompt ".ralph/tasks/my-task.code-task.md"
#
#   # From a rough description:
#   ralph run --config presets/code-assist.yml --prompt "Add a --verbose flag to the CLI"

event_loop:
  prompt_file: "PROMPT.md"
  completion_promise: "LOOP_COMPLETE"
  starting_event: "build.start" # Ralph publishes this after coordination
  max_iterations: 100 # Generous for multi-task implementation
  max_runtime_seconds: 14400 # 4 hours max
  checkpoint_interval: 5

cli:
  backend: "opencode"
  prompt_mode: "arg"

core:
  specs_dir: ".ralph/specs/"
  guardrails:
    - "Fresh context each iteration — save learnings to memories for next time"
    - "Verification is mandatory — tests/typecheck/lint/audit must pass"
    - "YAGNI ruthlessly — no speculative features"
    - "KISS always — simplest solution that works"
    - "Confidence protocol: score decisions 0-100. >80 proceed autonomously; 50-80 proceed + document in .ralph/agent/decisions.md; <50 choose safe default + document."
